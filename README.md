# Void Merchants

![Made with PICO-8](https://img.shields.io/badge/made%20with-PICO--8-red)
![Status: Beta](https://img.shields.io/badge/status-beta%20v0.9.7-yellow)

Void Merchants is a Space Invaders-inspired roguelike action game built in PICO-8. Blast enemies, collect resources and trade your way to upgrades as you progress through increasingly difficult space battles!

<p align="center">
    <img src="https://github.com/Scatenix/Void-Merchants/blob/main/resources/README/void-merchants.png" alt="Void Merchants" width="40%" />
</p>

### Fight, Travel, Trade!

<p align="center">
    <img src="https://github.com/Scatenix/Void-Merchants/blob/main/resources/README/void-merchants_fight.gif" alt="Void Merchants Fight" width="33%" />
    <img src="https://github.com/Scatenix/Void-Merchants/blob/main/resources/README/void-merchants_trade.gif" alt="Void Merchants Travel" width="33%" />
    <img src="https://github.com/Scatenix/Void-Merchants/blob/main/resources/README/void-merchants_travel.gif" alt="Void Merchants Trade" width="33%" />
</p>

Play the web version now! [Void Merchants](https://scatenix.github.io/Void-Merchants/)

## Controls

- ↑ ↓ ← → : Move your ship and cursor while trading
- X, V : Shoot (Can be held down)
- Y, C : Interact (talk to NPCs or perform trades)
- Create save games at each visit to the trader by hitting X or V
- Load them again at the title screen by hitting Y or C
- Enter : Open Pico-8s pause menu. E.g. to adjust the volume (Start button on a controller)

Can also be played with a controller! Tested with an Xbox controller - others may work too.

The buttons shown on screen are meant for the Playstation controller layout,
meaning that the X-button in-game is actually not the X-button on an Xbox controller. 

The controls can be adjusted in the PICO-8 settings (pause button located next to the bottom-right corner).

Make sure to check the [manual](https://github.com/Scatenix/Void-Merchants/releases/download/v0.9.7/manual.pdf) for more information about the game. Can be found on the release section!

## State of the Game

The game is currently in the balancing and testing phase, but already very playable.

There are only a few minor bugs and a few small game design oversights left.

All planned features have been implemented, except for a final boss fight, which was not possible, due to a code length restriction from PICO-8.

The game offers:
- A title screen with the possibility to load the last save
- Space fights from level 1 to 20
- Trading
- Upgrading the player ship and drone
- Collecting resources, dropped from the enemy ships
- Travel cutscenes between the battles
- Saving, which can be done whilst trading
- Brief conversations with the trader and a mysterious being

## Tech Stack

- Lua (PICO-8 dialect)
- The PICO-8 fantasy console
- Bash

## What is PICO-8?

PICO-8 is a fantasy console made by Lexaloffle Games for making, sharing and playing tiny games and other computer programs.

The hardware is intentionally very limited - it only has 2 MiB of RAM.

You can read more about it on the official FAQ: https://www.lexaloffle.com/pico-8.php?page=faq.

## Structure

- `root` directory - Contains the actual playable cartridge file `void-merchants.p8` as well as scripts to split and merge this cartridge.
- `game` - Contains individual PICO-8 code files for easier readability. Generated by the `split.sh` script and can be merged back to a playable cartridge with the `merge.sh` script.
- `docs` - Contains an exported version of the game to HTML and JavaScript to be played without the actual PICO-8 console. This is an official feature of PICO-8.

## Running the Game

Play the web version - [Void Merchants](https://scatenix.github.io/Void-Merchants/)

Note: The default sound volume can be a bit loud. I recommend lowering your browser's volume before starting.

The sound volume can be adjusted in the settings (pause button next to the bottom-right corner).

---

Or play it directly on the PICO-8 fantasy console by downloading this png and loading it into PICO-8:

<img src="https://github.com/Scatenix/Void-Merchants/blob/main/resources/cart/void-merchants.p8.png" alt="Void Merchants Game Cartridge" />

How to do this:
- Either open PICO-8 and drag and drop `void-merchants.p8.png` into the window (Alt+Enter to toggle fullscreen)
    - (Windows only) Or drag and drop `void-merchants.p8.png` onto the PICO-8.exe
- To save it permanently into your carts, type `save void-merchants`
    - To play the game later again, type `load void-merchants`
- To start the game, type `run` or hit ctrl+r

The game is not yet on the official splore game explorer.

## About the Performance

Because PICO-8 is using a virtualized CPU that is running at about 8 MHz, the game should run on pretty much every system.

- No more than 300 KiB RAM is being used, on top of what the PICO-8 runtime needs, in all scenarios I have tested
- For 20 enemies at level 20 (highest level) on one screen: rarely more than 0.3 CPUs of the virtualized PICO-8 Processor (a score of > 1.0 = game slowdown)
    - One wave can have a maximum of 9 enemies spawned at a time. A second wave will be spawned after some time. No more than 2 waves at the same time are possible
- All off-screen elements are mostly deleted or at least deactivated to avoid heavy calculations or useless rendering
    - Exception: Enemies that spawn behind other enemies will be fully calculated and rendered as an arrow at the right screen edge

Currently only less than 10 of 8192 tokens are left for the game code. There shouldn't really be any unused code, since I had to make sure there is nothing unnecessary to stay in this limit. This even includes comments.

## How to create a new Release

The majority of the release is being done on the local development environment through a bash script `release_void-merchants.sh`.
This approach was chosen to avoid having to include some of the unusual needed apps in a docker image for the release process.
Especially because of PICO-8 which I am not allowed to distribute.

The script is tested on Linux and Windows with the git-for-windows Bash.

The GitHub Action (`.github/workflows/release.yml`) only copies the release artifacts to the new release within the GitHub repository.

Pushing to main will automatically trigger a deploy of the contents in `docs/` to the repositories GitHub Pages site.
This will push the game as .html and .js, exported by PICO-8, to provide a playable web version.

Note: The binary icon will be taken from sprites 232, 233, 248 and 249. The beige pixels are configured to be transparent.

### Prerequisites

Following apps are needed for `release_void-merchants.sh`:

- bash
- sed
- PICO-8
- Git
- Libre Office
- 7-Zip

### Adjust the Release Script for your development Environment

3 variables need to be set within the script `release_void-merchants.sh`. This is done to avoid needing to have these apps in the PATH.

`PICO8_EXE="/path/to/pico8.exe"`

`_7Z_EXE="/path/to/7z.exe"`

`LIBRE_OFFICE_EXE="/path/to/soffice.exe"`

### Prepare the Release

- Make sure every change for the new release is commited, including the text in `Release-Text` that is used for the Release section on the GitHub repository.
- Adjust the new version number in the `VERSION` file in the project root. Else the release will fail.

### Release

- Execute the scripe `release_void-merchants.sh`
    - This will take a few seconds to generate all release artifacts
- You will be asked to check if everything is fine before committing and tagging the release
    - Use a git diff view. A handful of things will be automatically adjusted, like the version number accross different files
    - Cancel with n (no)
    - Confirm with y (yes)

The script will then automatically push the new version tag and to main and trigger the GitHub Actions.

## Disclaimer for Developers

Yes the code is messy. It got worse and worse throughout the commit history.
This is because of the extreme Pico-8 limitations, which forced me to rewrite some logic to use as little code as possible, remove a lot of comments and even stuff like magic numbers to avoid a single line of initialization of a variable (yes, I am that much on the edge of the limitations, e.g. v0.9.7 uses 8191 / 8192 tokens and a compressed capacity of 99.88%). All that while maintaining as much features as possible. Also, this is my first game ever, so things might be hackier than they really need to be. Especially the earlier code.

Yet, I am very happy and proud of my little game, which I believe, feels pretty polished :)

## Known Bugs

- Major: Game balancing needs to be tested!
    - The difficullty spikes dramatically at around level 11-13

The following points will likely not be tackled anymore, but leaving them here to keep them in mind.
- Minor: With the game save functionallity, Void Merchants is not a true rogue-like anymore.
    - I will leave it like this, to make it easier to play through and let the player decide
    - Loading will deduct 100 points from the score in the end to have at least a small incentive to play it without loading to often
- Minor: Down-scaled planets look terrible
    - I don't think this is possible easily, because there is no space for sprites left
- Minor: Sounds or music sometimes isn't played
    - Unavoidable at the moment because of only 4 sound channels, 2 of which are the game music. Game design would need to improve here

## License

All rights reserved.

Copyright (c) 2025 Scatenix (https://github.com/Scatenix)

This software, including the game and all assets, is provided for personal use only.
You may download and play the game, but you may not copy, modify, distribute,
or use it for any other purpose without the express written permission of the copyright holder.

The software is provided "as is", without warranty of any kind, express or
implied, including but not limited to the warranties of merchantability,
fitness for a particular purpose and noninfringement. In no event shall the
authors or copyright holders be liable for any claim, damages or other
liability, whether in an action of contract, tort or otherwise, arising from,
out of or in connection with the software or the use or other dealings in
the software.
